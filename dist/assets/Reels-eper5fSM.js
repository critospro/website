import{j as t}from"./ui-BaHh_PDK.js";import{H as b}from"./Header-17xN7_ax.js";import{r as a}from"./vendor-DV1f2hfo.js";import{s as g,B as p}from"./client-C2yhLZEv.js";import{D as v,e as y,a as w,c as N}from"./dialog-CxsE3Ocs.js";import{L as j}from"./LazyImage-CYNu65c7.js";import{c as U,p as L,g as R}from"./index-bsRtcvq8.js";import{u as _}from"./useProjects-DXQRdMu3.js";import"./router-CYBj0wdM.js";import"./index-1JOOFrA2.js";import"./settings-XI4ASVgq.js";import"./utils-6gDWDllp.js";import"./useQuery-DSPDO9qK.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=U("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),h=a.memo(({projects:l})=>{const[d,n]=a.useState(null),s=a.useRef(null);a.useEffect(()=>{if(l.length>0){const e=l.filter(o=>o.thumbnail_url).map(o=>u(o.thumbnail_url));L(e),setTimeout(()=>{R(e)},500)}},[l]);const u=e=>{if(!e)return"";if(e.startsWith("http"))return e;const{data:o}=g.storage.from("thumbnails").getPublicUrl(e);return o.publicUrl},c=e=>{var i,m;if(console.log("=== Getting video URL for:",e),e.startsWith("http://")||e.startsWith("https://"))return console.log("=== EXTERNAL URL detected, returning as-is:",e),e;if(e.includes("youtube.com/watch?v=")){const r=`https://www.youtube.com/embed/${(i=e.split("v=")[1])==null?void 0:i.split("&")[0]}`;return console.log("=== YouTube watch URL converted to embed:",r),r}if(e.includes("youtu.be/")){const r=`https://www.youtube.com/embed/${(m=e.split("youtu.be/")[1])==null?void 0:m.split("?")[0]}`;return console.log("=== YouTube short URL converted to embed:",r),r}const{data:o}=g.storage.from("videos").getPublicUrl(e);return console.log("=== Local file, generated Supabase storage URL:",o.publicUrl),o.publicUrl},f=e=>e.includes("youtube.com")||e.includes("youtu.be");return l.length===0?t.jsx("div",{className:"text-center py-20",children:t.jsx("p",{className:"text-muted-foreground text-lg",children:"No reels available yet."})}):t.jsx(t.Fragment,{children:t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:l.map((e,o)=>t.jsxs(v,{children:[t.jsx(y,{asChild:!0,children:t.jsxs("div",{className:"aspect-[9/16] relative group cursor-pointer overflow-hidden rounded-lg bg-muted",children:[e.thumbnail_url&&t.jsx(j,{src:u(e.thumbnail_url),alt:e.title,fastPreview:!0,priority:o<4,eager:o<2,className:"w-full h-full transition-transform duration-300 group-hover:scale-105"}),t.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center",children:t.jsx(p,{size:"lg",className:"rounded-full w-16 h-16 bg-white/20 hover:bg-white/30 border border-white/50",onClick:()=>n(e),children:t.jsx(T,{className:"w-6 h-6 text-white ml-1"})})}),t.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-3 bg-gradient-to-t from-black/80 to-transparent",children:[t.jsx("h3",{className:"text-white text-sm font-medium truncate",children:e.title}),t.jsx("p",{className:"text-white/80 text-xs truncate",children:e.client})]})]})}),t.jsxs(w,{className:"max-w-md p-0 bg-black",children:[t.jsx(N,{className:"sr-only",children:e.title}),t.jsx("div",{className:"aspect-[9/16] relative",children:e.video_url&&t.jsx(t.Fragment,{children:f(e.video_url)?t.jsx("iframe",{src:c(e.video_url),className:"w-full h-full",allowFullScreen:!0,title:e.title}):t.jsx("video",{ref:s,src:c(e.video_url),className:"w-full h-full object-cover",controls:!0,playsInline:!0,preload:"metadata",title:e.title,crossOrigin:"anonymous",onLoadStart:()=>console.log("Video load started"),onLoadedData:()=>{console.log("Video data loaded"),s.current&&(s.current.muted=!1,s.current.volume=1)},onCanPlay:()=>{console.log("Video can play"),s.current&&(s.current.muted=!1,s.current.volume=1)},onPlay:()=>{console.log("Video started playing with sound"),s.current&&(s.current.muted=!1,s.current.volume=1)},onError:i=>{console.error("Video failed to load:",i),console.log("Video URL:",c(e.video_url)),console.log("Original video_url:",e.video_url)}})})})]})]},e.id))})})});h.displayName="ReelsGrid";const A=()=>{const{projects:l,isLoading:d}=_(),n=l.filter(s=>s.is_video&&s.video_url);return t.jsxs("div",{className:"min-h-screen bg-background",children:[t.jsx(b,{}),t.jsx("main",{className:"pt-24",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-8 py-12",children:[t.jsxs("div",{className:"text-center mb-12",children:[t.jsx("h1",{className:"text-4xl md:text-6xl font-light text-foreground mb-4",children:"Reels"}),t.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"A collection of short-form video content showcasing our creative storytelling"})]}),d?t.jsx("div",{className:"flex items-center justify-center py-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):t.jsx(h,{projects:n})]})})]})};export{A as default};
