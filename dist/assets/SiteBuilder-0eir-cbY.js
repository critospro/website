var J=Object.defineProperty,W=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var U=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var $=(a,r,s)=>r in a?J(a,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[r]=s,u=(a,r)=>{for(var s in r||(r={}))Y.call(r,s)&&$(a,s,r[s]);if(U)for(var s of U(r))Z.call(r,s)&&$(a,s,r[s]);return a},g=(a,r)=>W(a,X(r));var _=(a,r,s)=>new Promise((o,l)=>{var i=x=>{try{h(s.next(x))}catch(t){l(t)}},n=x=>{try{h(s.throw(x))}catch(t){l(t)}},h=x=>x.done?o(x.value):Promise.resolve(x.value).then(i,n);h((s=s.apply(a,r)).next())});import{j as e}from"./ui-BaHh_PDK.js";import{r as f}from"./vendor-DV1f2hfo.js";import{s as F,B as H}from"./client-C2yhLZEv.js";import{C,a as b,b as S,c as k,d as T}from"./card-HLq6nJpV.js";import{T as ee,a as se,b as w,c as L}from"./tabs-CQKSgWdH.js";import{L as v,I as E}from"./label-Bor1O0BV.js";import{I as ae,a as q,b as A,c as z,d as D,e as N,S as te}from"./select-C1EipiMc.js";import{u as re}from"./useQuery-DSPDO9qK.js";import{c as P,e as ne,d as Q}from"./index-bsRtcvq8.js";import{u as le,P as ce}from"./useMutation-Bu70clFN.js";import{S as oe}from"./settings-XI4ASVgq.js";import{u as ie}from"./router-CYBj0wdM.js";import"./index-1JOOFrA2.js";import"./utils-6gDWDllp.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=P("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=P("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=P("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=P("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),he=a=>{const r=ne(),{data:s=[],isLoading:o}=re({queryKey:["site-settings",a],queryFn:()=>_(void 0,null,function*(){if(!a)return[];const{data:t,error:m}=yield F.from("site_settings").select("*").eq("user_id",a);if(m)throw m;return t}),enabled:!!a}),l=le({mutationFn:p=>_(void 0,[p],function*({key:t,value:m}){if(!a)throw new Error("User ID required");const{data:j,error:y}=yield F.from("site_settings").upsert({user_id:a,setting_key:t,setting_value:m},{onConflict:"user_id,setting_key"}).select().single();if(y)throw y;return j}),onSuccess:()=>{r.invalidateQueries({queryKey:["site-settings",a]}),Q.success("Settings updated successfully!")},onError:t=>{Q.error("Failed to update settings: "+t.message)}}),i=()=>{const t=s.find(m=>m.setting_key==="theme");return(t==null?void 0:t.setting_value)||{colors:{primary:"0 0% 98%",background:"0 0% 4%",accent:"180 100% 35%"},siteName:"My Portfolio"}},n=()=>{const t=s.find(m=>m.setting_key==="layout");return(t==null?void 0:t.setting_value)||{headerStyle:"default",gridColumns:3,spacing:"normal"}};return{settings:s,isLoading:o,getTheme:i,getLayout:n,updateTheme:t=>{const m=i();l.mutate({key:"theme",value:u(u({},m),t)})},updateLayout:t=>{const m=n();l.mutate({key:"layout",value:u(u({},m),t)})},updateSetting:l.mutate,isUpdating:l.isPending}},xe=({userId:a,onClose:r})=>{const{getTheme:s,getLayout:o,updateTheme:l,updateLayout:i,isUpdating:n}=he(a),[h,x]=f.useState("theme"),t=s(),m=o(),[p,j]=f.useState(t),[y,M]=f.useState(m);f.useEffect(()=>{j(t),M(m)},[t,m]);const V=(c,d)=>{const R=ge(d);j(I=>g(u({},I),{colors:g(u({},I.colors),{[c]:R})}))},G=()=>{l(p),pe(p)},O=()=>{i(y)};return e.jsxs("div",{className:"w-full h-full bg-background",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Site Builder"}),e.jsx(H,{variant:"outline",onClick:r,children:"Close"})]}),e.jsxs(ee,{value:h,onValueChange:x,className:"w-full h-full",children:[e.jsxs(se,{className:"grid w-full grid-cols-5 m-4",children:[e.jsxs(w,{value:"theme",className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4"}),"Theme"]}),e.jsxs(w,{value:"layout",className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4"}),"Layout"]}),e.jsxs(w,{value:"content",className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Content"]}),e.jsxs(w,{value:"media",className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),"Media"]}),e.jsxs(w,{value:"settings",className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4"}),"Settings"]})]}),e.jsxs("div",{className:"p-4 h-full overflow-y-auto",children:[e.jsx(L,{value:"theme",className:"space-y-6",children:e.jsxs(C,{children:[e.jsxs(b,{children:[e.jsx(S,{children:"Color Scheme"}),e.jsx(k,{children:"Customize your site's color palette"})]}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"primary-color",children:"Primary Color"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("input",{type:"color",value:B(p.colors.primary),onChange:c=>V("primary",c.target.value),className:"w-12 h-8 rounded border"}),e.jsx(E,{value:p.colors.primary,onChange:c=>j(d=>g(u({},d),{colors:g(u({},d.colors),{primary:c.target.value})})),placeholder:"HSL values"})]})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"accent-color",children:"Accent Color"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("input",{type:"color",value:B(p.colors.accent),onChange:c=>V("accent",c.target.value),className:"w-12 h-8 rounded border"}),e.jsx(E,{value:p.colors.accent,onChange:c=>j(d=>g(u({},d),{colors:g(u({},d.colors),{accent:c.target.value})})),placeholder:"HSL values"})]})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"background-color",children:"Background Color"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("input",{type:"color",value:B(p.colors.background),onChange:c=>V("background",c.target.value),className:"w-12 h-8 rounded border"}),e.jsx(E,{value:p.colors.background,onChange:c=>j(d=>g(u({},d),{colors:g(u({},d.colors),{background:c.target.value})})),placeholder:"HSL values"})]})]})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"site-name",children:"Site Name"}),e.jsx(E,{value:p.siteName,onChange:c=>j(d=>g(u({},d),{siteName:c.target.value})),placeholder:"Enter your site name",className:"mt-2"})]}),e.jsxs(H,{onClick:G,disabled:n,className:"w-full",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Save Theme"]})]})]})}),e.jsx(L,{value:"layout",className:"space-y-6",children:e.jsxs(C,{children:[e.jsxs(b,{children:[e.jsx(S,{children:"Layout Settings"}),e.jsx(k,{children:"Configure your site's layout and structure"})]}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(v,{children:"Header Style"}),e.jsxs(q,{value:y.headerStyle,onValueChange:c=>M(d=>g(u({},d),{headerStyle:c})),children:[e.jsx(A,{className:"mt-2",children:e.jsx(z,{})}),e.jsxs(D,{children:[e.jsx(N,{value:"default",children:"Default"}),e.jsx(N,{value:"minimal",children:"Minimal"}),e.jsx(N,{value:"centered",children:"Centered"})]})]})]}),e.jsxs("div",{children:[e.jsxs(v,{children:["Grid Columns: ",y.gridColumns]}),e.jsx(te,{value:[y.gridColumns],onValueChange:([c])=>M(d=>g(u({},d),{gridColumns:c})),min:1,max:6,step:1,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(v,{children:"Spacing"}),e.jsxs(q,{value:y.spacing,onValueChange:c=>M(d=>g(u({},d),{spacing:c})),children:[e.jsx(A,{className:"mt-2",children:e.jsx(z,{})}),e.jsxs(D,{children:[e.jsx(N,{value:"tight",children:"Tight"}),e.jsx(N,{value:"normal",children:"Normal"}),e.jsx(N,{value:"loose",children:"Loose"})]})]})]}),e.jsxs(H,{onClick:O,disabled:n,className:"w-full",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Save Layout"]})]})]})}),e.jsx(L,{value:"content",className:"space-y-6",children:e.jsxs(C,{children:[e.jsxs(b,{children:[e.jsx(S,{children:"Content Management"}),e.jsx(k,{children:"Manage your site's content and pages"})]}),e.jsx(T,{children:e.jsx("p",{className:"text-muted-foreground",children:"Page management coming soon..."})})]})}),e.jsx(L,{value:"media",className:"space-y-6",children:e.jsxs(C,{children:[e.jsxs(b,{children:[e.jsx(S,{children:"Media Management"}),e.jsx(k,{children:"Upload and manage your site's images and videos"})]}),e.jsx(T,{children:e.jsx("p",{className:"text-muted-foreground",children:"Media management coming soon..."})})]})}),e.jsx(L,{value:"settings",className:"space-y-6",children:e.jsxs(C,{children:[e.jsxs(b,{children:[e.jsx(S,{children:"Site Settings"}),e.jsx(k,{children:"Configure general site settings"})]}),e.jsx(T,{children:e.jsx("p",{className:"text-muted-foreground",children:"Additional settings coming soon..."})})]})})]})]})]})},ge=a=>{const r=parseInt(a.slice(1,3),16)/255,s=parseInt(a.slice(3,5),16)/255,o=parseInt(a.slice(5,7),16)/255,l=Math.max(r,s,o),i=Math.min(r,s,o);let n,h,x=(l+i)/2;if(l===i)n=h=0;else{const t=l-i;switch(h=x>.5?t/(2-l-i):t/(l+i),l){case r:n=(s-o)/t+(s<o?6:0);break;case s:n=(o-r)/t+2;break;case o:n=(r-s)/t+4;break;default:n=0}n/=6}return`${Math.round(n*360)} ${Math.round(h*100)}% ${Math.round(x*100)}%`},B=a=>{const[r,s,o]=a.split(" ").map((n,h)=>h===0?parseInt(n)/360:parseInt(n.replace("%",""))/100),l=s*Math.min(o,1-o),i=n=>{const h=(n+r*12)%12,x=o-l*Math.max(Math.min(h-3,9-h,1),-1);return Math.round(255*x).toString(16).padStart(2,"0")};return`#${i(0)}${i(8)}${i(4)}`},pe=a=>{const r=document.documentElement;Object.entries(a.colors).forEach(([s,o])=>{r.style.setProperty(`--${s}`,o)})},He=()=>{const[a,r]=f.useState(null),[s,o]=f.useState(!0),l=ie();f.useEffect(()=>{i()},[]);const i=()=>_(void 0,null,function*(){try{const{data:{user:n}}=yield F.auth.getUser();if(!n){l("/auth");return}r(n)}catch(n){console.error("Error checking user:",n),l("/auth")}finally{o(!1)}});return s?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"border-b p-4",children:e.jsxs(H,{variant:"outline",onClick:()=>l("/admin"),className:"mb-4",children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Back to Admin"]})}),a&&e.jsx(xe,{userId:a.id,onClose:()=>l("/admin")})]})};export{He as default};
