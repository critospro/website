var fr=Object.defineProperty,hr=Object.defineProperties;var gr=Object.getOwnPropertyDescriptors;var nt=Object.getOwnPropertySymbols;var Kt=Object.prototype.hasOwnProperty,Jt=Object.prototype.propertyIsEnumerable;var xt=Math.pow,Gt=(e,t,n)=>t in e?fr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,y=(e,t)=>{for(var n in t||(t={}))Kt.call(t,n)&&Gt(e,n,t[n]);if(nt)for(var n of nt(t))Jt.call(t,n)&&Gt(e,n,t[n]);return e},R=(e,t)=>hr(e,gr(t));var ve=(e,t)=>{var n={};for(var r in e)Kt.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&nt)for(var r of nt(e))t.indexOf(r)<0&&Jt.call(e,r)&&(n[r]=e[r]);return n};var F=(e,t,n)=>new Promise((r,s)=>{var a=d=>{try{c(n.next(d))}catch(u){s(u)}},i=d=>{try{c(n.throw(d))}catch(u){s(u)}},c=d=>d.done?r(d.value):Promise.resolve(d.value).then(a,i);c((n=n.apply(e,t)).next())});import{j as o,a as pr,O as Cn,k as Dn,l as mr,m as En,n as Rn,o as vr}from"./ui-BaHh_PDK.js";import{C as br,H as xr}from"./Header-17xN7_ax.js";import{r as l,a as _,b as Ue}from"./vendor-DV1f2hfo.js";import{P as wr,U as kn,a as yr,S as jr}from"./ProjectCard-eyXnivoN.js";import{c as xe,X as Mn,u as In,a as ut,b as Sr}from"./index-bsRtcvq8.js";import{B as V,s as Q}from"./client-C2yhLZEv.js";import{D as An,a as Tn,b as Nr,c as Cr,d as Dr}from"./dialog-CxsE3Ocs.js";import{L as Nt}from"./LazyImage-CYNu65c7.js";import{L as ye,I as at}from"./label-Bor1O0BV.js";import{S as Qt,a as Zt,b as en,c as tn,d as nn,e as rn,I as sn}from"./select-C1EipiMc.js";import{T as Er,a as Rr,b as on,c as an}from"./tabs-CQKSgWdH.js";import"./card-HLq6nJpV.js";import"./router-CYBj0wdM.js";import"./index-1JOOFrA2.js";import"./settings-XI4ASVgq.js";import"./utils-6gDWDllp.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=xe("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=xe("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=xe("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=xe("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=xe("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=xe("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=xe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=xe("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),Or=({src:e,poster:t,className:n,onLoadStart:r,autoplay:s=!1,fastPreview:a=!0,eager:i=!1})=>{const[c,d]=l.useState(!1),[u,p]=l.useState(!1),[f,g]=l.useState(!0),h=l.useRef(null);l.useEffect(()=>{if(i){d(!0);return}const w=new IntersectionObserver(([S])=>{S.isIntersecting&&(d(!0),a&&s&&g(!1),w.disconnect())},{rootMargin:a?"200px":"100px"});return h.current&&w.observe(h.current),()=>w.disconnect()},[a,s,i]);const v=()=>{p(!0),r==null||r()},m=()=>{g(!1)},x=()=>{var w;a&&s&&c&&((w=h.current)==null||w.play())};return o.jsxs("div",{className:`relative ${n}`,children:[f&&t&&o.jsxs("div",{className:"absolute inset-0 z-10 cursor-pointer animate-fade-in",onClick:m,children:[o.jsx("img",{src:t,alt:"Video thumbnail",className:"w-full h-full object-cover",loading:i?"eager":"lazy",fetchPriority:i?"high":"auto"}),o.jsx("div",{className:"absolute inset-0 bg-black/20 flex items-center justify-center",children:o.jsx("div",{className:"w-16 h-16 bg-white/90 rounded-full flex items-center justify-center hover-scale",children:o.jsx("div",{className:"w-0 h-0 border-l-8 border-r-0 border-t-4 border-b-4 border-l-black border-t-transparent border-b-transparent ml-1"})})})]}),o.jsxs("video",{ref:h,muted:!0,loop:!0,playsInline:!0,controls:!f,preload:a?"none":"metadata",poster:a?void 0:t,className:"w-full h-full object-cover",onCanPlay:v,onPlay:m,onLoadedMetadata:x,style:{opacity:u?1:.8,transition:"opacity 0.3s ease",display:f?"none":"block"},children:[c&&o.jsx("source",{src:e,type:"video/mp4"}),"Your browser does not support the video tag."]})]})},Lr="/assets/safari-project-DotFjw5s.jpg",Fr="/assets/hotel-interior-Djk-M83h.jpg",zr="/assets/experience-project-0J4XpsWV.jpg",Ur=()=>{const[e,t]=l.useState("Hotels, Safari and Travel Experience"),[n,r]=l.useState(!1),[s,a]=l.useState(e),i=()=>{t(s),r(!1)},c=()=>{a(e),r(!1)},d=[{title:"TNS kimarishe",client:"Wilderness Safari",date:"4/22/2024",image:Lr,isVideo:!0,videoUrl:"https://www.youtube.com/watch?v=FrlyTL5fQts"},{title:"Luxury Resort",client:"Four Seasons",date:"3/15/2024",image:Fr,isVideo:!0},{title:"Adventure Experience",client:"Airbnb Experiences",date:"2/28/2024",image:zr,isVideo:!0},{title:"Hotel Campaign",client:"Marriott International",date:"1/18/2024",image:"https://images.unsplash.com/photo-1571896349842-33c89424de2d?w=800&h=600&fit=crop&crop=center",isVideo:!0},{title:"Safari Documentary",client:"National Geographic",date:"12/10/2023",image:"https://images.unsplash.com/photo-1516426122078-c23e76319801?w=800&h=600&fit=crop&crop=center",isVideo:!0},{title:"Boutique Hotel",client:"Design Hotels",date:"11/22/2023",image:"https://images.unsplash.com/photo-1445019980597-93fa8acb246c?w=800&h=600&fit=crop&crop=center",isVideo:!0}];return o.jsx("section",{id:"home",className:"min-h-screen bg-black pt-20 px-8",children:o.jsxs("div",{className:"max-w-6xl mx-auto",children:[o.jsxs("div",{className:"text-left space-y-16 animate-fade-in pt-[65px] pl-4 md:pl-8",children:[o.jsx("div",{className:"space-y-6",children:o.jsxs("h1",{className:"text-2xl md:text-4xl font-light leading-relaxed tracking-tight lg:text-4xl",children:[o.jsx("span",{className:"text-foreground font-normal",children:"I'm a visual artist, I tell stories through Film and Photography"}),o.jsx("br",{}),o.jsx("span",{className:"text-foreground",children:"that "}),o.jsx("span",{className:"text-foreground font-normal",children:"captures stunning visuals for"}),o.jsx("br",{}),o.jsx("span",{className:"text-muted-foreground font-light italic",children:n?o.jsxs("span",{className:"inline-flex items-center gap-2",children:[o.jsx("input",{type:"text",value:s,onChange:u=>a(u.target.value),className:"bg-transparent border-b border-muted-foreground/30 focus:border-muted-foreground outline-none font-light italic",onKeyDown:u=>{u.key==="Enter"&&i(),u.key==="Escape"&&c()},autoFocus:!0}),o.jsx("button",{onClick:i,className:"text-green-400 hover:text-green-300",children:"✓"}),o.jsx("button",{onClick:c,className:"text-red-400 hover:text-red-300",children:"✕"})]}):o.jsxs("span",{className:"group inline-flex items-center gap-2",children:[e,o.jsx("button",{onClick:()=>{a(e),r(!0)},className:"opacity-0 group-hover:opacity-100 transition-opacity ml-2",children:o.jsx(Tr,{className:"w-3 h-3"})})]})})]})}),o.jsxs("div",{className:"flex flex-col md:flex-row items-start justify-start gap-8 text-muted-foreground text-sm font-light",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),o.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),o.jsx("span",{children:"Arusha,TZ / World"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),o.jsx("polyline",{points:"22,6 12,13 2,6"})]}),o.jsx("span",{children:"info@critospro.com"})]})]})]}),o.jsxs("div",{className:"mt-20 mb-20",children:[o.jsx("div",{className:"relative group cursor-pointer animate-slide-up",children:o.jsx("div",{className:"relative aspect-video rounded-2xl overflow-hidden bg-card shadow-cinematic video-grain",children:o.jsx(Or,{src:"https://ijgrizsbxnevkngbidew.supabase.co/storage/v1/object/public/videos/cmapaign%20video/Aromatic%20Atlier%20.mp4",poster:"https://ijgrizsbxnevkngbidew.supabase.co/storage/v1/object/public/thumbnails/Aromatic%20Atalier.jpg?v=1",className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-[1.02]",eager:!0,onLoadStart:()=>{const u=navigator.connection,p=!u||u.effectiveType==="4g",f=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(p&&!f){const g=document.querySelector("video");g&&setTimeout(()=>g.play().catch(()=>{}),500)}}})})}),o.jsx("div",{className:"mt-20 space-y-12",children:o.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-16 opacity-40",children:[o.jsx("div",{className:"text-muted-foreground font-light text-lg tracking-widest",children:"TNS"}),o.jsx("div",{className:"text-muted-foreground font-light text-lg tracking-widest",children:"EMERALD ESCAPE"}),o.jsx("div",{className:"text-muted-foreground font-light text-lg tracking-widest",children:"NYUMBA NDOTO"})]})})]}),o.jsx("div",{className:"mt-20 mb-20",children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 animate-fade-in",children:d.map((u,p)=>o.jsx("div",{style:{animationDelay:`${p*.1}s`},children:o.jsx(wr,y({},u))},p))})})]})})};var Br="AspectRatio",Pn=l.forwardRef((e,t)=>{const a=e,{ratio:n=1/1,style:r}=a,s=ve(a,["ratio","style"]);return o.jsx("div",{style:{position:"relative",width:"100%",paddingBottom:`${100/n}%`},"data-radix-aspect-ratio-wrapper":"",children:o.jsx(pr.div,R(y({},s),{ref:t,style:R(y({},r),{position:"absolute",top:0,right:0,bottom:0,left:0})}))})});Pn.displayName=Br;var $r=Pn;const _r=$r,Vr=[{value:"col-span-1 row-span-1",label:"Small (1x1)"},{value:"col-span-2 row-span-1",label:"Wide (2x1)"},{value:"col-span-1 row-span-2",label:"Tall (1x2)"},{value:"col-span-2 row-span-2",label:"Large (2x2)"},{value:"col-span-3 row-span-1",label:"Extra Wide (3x1)"},{value:"col-span-1 row-span-3",label:"Extra Tall (1x3)"},{value:"col-span-3 row-span-2",label:"XL Wide (3x2)"},{value:"col-span-2 row-span-3",label:"XL Tall (2x3)"},{value:"col-span-4 row-span-1",label:"Full Width (4x1)"},{value:"col-span-4 row-span-2",label:"Full Wide (4x2)"}],Wr=[{value:"cover",label:"Cover (crop to fill)"},{value:"contain",label:"Contain (fit fully)"},{value:"fill",label:"Fill (stretch to fit)"},{value:"scale-down",label:"Scale Down (smaller of contain/none)"},{value:"none",label:"None (original size)"}],Hr=e=>{const t=e.match(/col-span-(\d+)/),n=e.match(/row-span-(\d+)/);return{width:t?parseInt(t[1]):1,height:n?parseInt(n[1]):1}},Xr=(e,t)=>`col-span-${e} row-span-${t}`,qr=({photo:e,isOpen:t,onClose:n,onSave:r,onDelete:s})=>{const[a,i]=l.useState(e),[c,d]=l.useState(!1);console.log("PhotoEditor render - photo:",e,"isOpen:",t),l.useEffect(()=>{console.log("PhotoEditor useEffect - photo changed:",e),i(e)},[e]);const u=a?Hr(a.grid_class):{width:1,height:1},p=(h,v)=>{const m=Xr(h,v);i(x=>x?R(y({},x),{grid_class:m}):null)},f=()=>{a&&(r(a),n())},g=()=>{e&&s(e.id)};return!e||!a?null:o.jsx(An,{open:t,onOpenChange:n,children:o.jsxs(Tn,{className:"sm:max-w-[500px]",children:[o.jsx(Nr,{children:o.jsx(Cr,{children:"Edit Photo"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"relative aspect-video rounded-lg overflow-hidden bg-muted",children:o.jsx("img",{src:a.src,alt:a.alt,className:`w-full h-full object-${a.object_fit||"cover"}`})}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(ye,{htmlFor:"src",children:"Image URL"}),o.jsx(at,{id:"src",value:a.src,onChange:h=>i(v=>v?R(y({},v),{src:h.target.value}):null),placeholder:"https://example.com/image.jpg"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(ye,{htmlFor:"alt",children:"Alt Text"}),o.jsx(at,{id:"alt",value:a.alt,onChange:h=>i(v=>v?R(y({},v),{alt:h.target.value}):null),placeholder:"Describe the image"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(ye,{children:"Image Size"}),o.jsx(V,{type:"button",variant:"outline",size:"sm",onClick:()=>d(!c),children:c?"Presets":"Custom"})]}),c?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsxs(ye,{children:["Width: ",u.width," columns"]}),o.jsx("span",{className:"text-sm text-muted-foreground",children:"Max: 6"})]}),o.jsx(Qt,{value:[u.width],onValueChange:([h])=>p(h,u.height),max:6,min:1,step:1,className:"w-full"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsxs(ye,{children:["Height: ",u.height," rows"]}),o.jsx("span",{className:"text-sm text-muted-foreground",children:"Max: 4"})]}),o.jsx(Qt,{value:[u.height],onValueChange:([h])=>p(u.width,h),max:4,min:1,step:1,className:"w-full"})]}),o.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[o.jsx("div",{className:"text-sm font-medium mb-2",children:"Preview Grid Size:"}),o.jsx("div",{className:"grid grid-cols-6 gap-1 w-32 h-16",children:Array.from({length:24},(h,v)=>{const m=v%6+1,x=Math.floor(v/6)+1,w=m<=u.width&&x<=u.height;return o.jsx("div",{className:`aspect-square rounded-sm ${w?"bg-primary":"bg-muted-foreground/20"}`},v)})})]})]}):o.jsxs(Zt,{value:a.grid_class,onValueChange:h=>i(v=>v?R(y({},v),{grid_class:h}):null),children:[o.jsx(en,{children:o.jsx(tn,{placeholder:"Select grid size"})}),o.jsx(nn,{children:Vr.map(h=>o.jsx(rn,{value:h.value,children:h.label},h.value))})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(ye,{children:"Image Fit"}),o.jsxs(Zt,{value:a.object_fit||"cover",onValueChange:h=>i(v=>v?R(y({},v),{object_fit:h}):null),children:[o.jsx(en,{children:o.jsx(tn,{placeholder:"Select how image fits"})}),o.jsx(nn,{children:Wr.map(h=>o.jsx(rn,{value:h.value,children:h.label},h.value))})]})]})]}),o.jsxs(Dr,{className:"flex justify-between gap-4",children:[o.jsx(V,{variant:"destructive",onClick:g,className:"mr-auto",children:"Delete Photo"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(V,{variant:"outline",onClick:n,children:"Cancel"}),o.jsx(V,{onClick:f,children:"Save Changes"})]})]})]})})},Yr=({onUpload:e,onCancel:t,isUploading:n=!1})=>{const[r,s]=l.useState(!1),[a,i]=l.useState(null),[c,d]=l.useState(""),[u,p]=l.useState(null),f=l.useCallback(w=>{w.preventDefault(),s(!0)},[]),g=l.useCallback(w=>{w.preventDefault(),s(!1)},[]),h=l.useCallback(w=>{w.preventDefault(),s(!1);const j=Array.from(w.dataTransfer.files).find(N=>N.type.startsWith("image/"));if(j){i(j);const N=URL.createObjectURL(j);p(N)}},[]),v=l.useCallback(w=>{var j;const S=(j=w.target.files)==null?void 0:j[0];if(S&&S.type.startsWith("image/")){i(S);const N=URL.createObjectURL(S);p(N)}},[]),m=()=>F(void 0,null,function*(){a&&c.trim()&&(yield e(a,c.trim()),i(null),d(""),p(null))}),x=()=>{i(null),d(""),u&&(URL.revokeObjectURL(u),p(null))};return o.jsx("div",{className:"space-y-4",children:a?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"aspect-video rounded-lg overflow-hidden bg-muted",children:o.jsx("img",{src:u||"",alt:"Preview",className:"w-full h-full object-cover"})}),o.jsx(V,{size:"sm",variant:"secondary",onClick:x,className:"absolute top-2 right-2",children:o.jsx(Mn,{className:"w-4 h-4"})})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(ye,{htmlFor:"alt-text",children:"Image Description (Alt Text)"}),o.jsx(at,{id:"alt-text",value:c,onChange:w=>d(w.target.value),placeholder:"Describe what's in this image...",disabled:n})]}),o.jsxs("div",{className:"flex gap-2 justify-end",children:[o.jsx(V,{variant:"outline",onClick:t,disabled:n,children:"Cancel"}),o.jsx(V,{onClick:m,disabled:!c.trim()||n,children:n?"Uploading...":"Upload Photo"})]})]}):o.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${r?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary/50"}`,onDragOver:f,onDragLeave:g,onDrop:h,children:[o.jsx(kn,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),o.jsx("p",{className:"text-lg font-medium mb-2",children:"Drop your image here"}),o.jsx("p",{className:"text-muted-foreground mb-4",children:"or click to browse"}),o.jsx("input",{type:"file",accept:"image/*",onChange:v,className:"hidden",id:"file-input"}),o.jsx(V,{variant:"outline",asChild:!0,children:o.jsx("label",{htmlFor:"file-input",className:"cursor-pointer",children:"Choose Image"})})]})})},Gr=({onSelectFile:e,onCancel:t,bucketName:n="photos"})=>{const[r,s]=l.useState([]),[a,i]=l.useState([]),[c,d]=l.useState(!0),[u,p]=l.useState(""),[f,g]=l.useState("grid"),[h,v]=l.useState(n),[m,x]=l.useState(""),{toast:w}=In(),S=["photos","videos","thumbnails"];l.useEffect(()=>{j()},[h,m]),l.useEffect(()=>{const b=r.filter(P=>P.name.toLowerCase().includes(u.toLowerCase()));i(b)},[r,u]);const j=()=>F(void 0,null,function*(){d(!0);try{const{data:b,error:P}=yield Q.storage.from(h).list(m,{limit:100,offset:0});if(P)throw P;s(b||[])}catch(b){console.error("Error fetching files:",b),w({title:"Error",description:"Failed to load files from storage",variant:"destructive"})}finally{d(!1)}}),N=b=>{const P=m?`${m}/${b}`:b;return`https://ijgrizsbxnevkngbidew.supabase.co/storage/v1/object/public/${h}/${P}`},k=b=>/\.(jpg|jpeg|png|gif|webp|svg)$/i.test(b),A=b=>/\.(mp4|webm|ogg|mov|avi)$/i.test(b),D=b=>!b.metadata&&!k(b.name)&&!A(b.name)&&!b.name.includes("."),M=b=>{if(D(b)){const P=m?`${m}/${b.name}`:b.name;x(P),p("")}else{const P=N(b.name);e(P,b.name)}},C=()=>{const b=m.split("/");b.pop(),x(b.join("/")),p("")},E=()=>{x(""),p("")},I=()=>m?m.split("/"):[];return c?o.jsx("div",{className:"p-6 border border-border rounded-lg bg-card",children:o.jsx("div",{className:"text-center",children:o.jsx("div",{className:"animate-pulse",children:"Loading storage files..."})})}):o.jsxs("div",{className:"p-6 border border-border rounded-lg bg-card max-h-[600px] flex flex-col",children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("h3",{className:"text-lg font-medium mb-4",children:"Select from Storage"}),m&&o.jsxs("div",{className:"flex items-center gap-2 mb-3 text-sm text-muted-foreground",children:[o.jsxs("button",{onClick:E,className:"hover:text-foreground flex items-center gap-1",children:[o.jsx(Ir,{className:"w-4 h-4"}),h]}),I().map((b,P)=>o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(br,{className:"w-4 h-4"}),o.jsx("span",{children:b})]},P)),m&&o.jsx("button",{onClick:C,className:"ml-2 px-2 py-1 text-xs bg-muted hover:bg-muted/80 rounded",children:"Back"})]}),o.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[o.jsx("select",{value:h,onChange:b=>v(b.target.value),className:"px-3 py-2 border border-border rounded-md bg-background text-foreground",children:S.map(b=>o.jsx("option",{value:b,children:b},b))}),o.jsxs("div",{className:"relative flex-1 min-w-48",children:[o.jsx(Pr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),o.jsx(at,{placeholder:"Search files...",value:u,onChange:b=>p(b.target.value),className:"pl-10"})]}),o.jsxs("div",{className:"flex gap-1 border border-border rounded-md p-1",children:[o.jsx(V,{size:"sm",variant:f==="grid"?"default":"ghost",onClick:()=>g("grid"),className:"px-2 py-1",children:o.jsx(Mr,{className:"w-4 h-4"})}),o.jsx(V,{size:"sm",variant:f==="list"?"default":"ghost",onClick:()=>g("list"),className:"px-2 py-1",children:o.jsx(Ar,{className:"w-4 h-4"})})]})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:a.length===0?o.jsxs("div",{className:"text-center text-muted-foreground py-8",children:["No files found in ",h," bucket"]}):o.jsx("div",{className:f==="grid"?"grid grid-cols-4 gap-3":"space-y-2",children:a.map(b=>o.jsx("div",{onClick:()=>M(b),className:`cursor-pointer border border-border rounded-md hover:border-primary/50 transition-colors ${f==="grid"?"p-2 aspect-square":"p-3 flex items-center gap-3"}`,children:f==="grid"?o.jsxs("div",{className:"w-full h-full flex flex-col",children:[o.jsx("div",{className:"flex-1 flex items-center justify-center bg-muted rounded mb-2",children:D(b)?o.jsx(ln,{className:"w-8 h-8 text-muted-foreground"}):k(b.name)?o.jsx(Nt,{src:N(b.name),alt:b.name,className:"w-full h-full object-cover rounded"}):A(b.name)?o.jsx(cn,{className:"w-8 h-8 text-muted-foreground"}):o.jsx(sn,{className:"w-8 h-8 text-muted-foreground"})}),o.jsx("p",{className:"text-xs truncate text-center",children:b.name})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-muted rounded",children:D(b)?o.jsx(ln,{className:"w-6 h-6 text-muted-foreground"}):k(b.name)?o.jsx(Nt,{src:N(b.name),alt:b.name,className:"w-full h-full object-cover rounded"}):A(b.name)?o.jsx(cn,{className:"w-6 h-6 text-muted-foreground"}):o.jsx(sn,{className:"w-6 h-6 text-muted-foreground"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"font-medium truncate",children:b.name}),o.jsx("p",{className:"text-sm text-muted-foreground",children:D(b)?"Folder":b.updated_at?new Date(b.updated_at).toLocaleDateString():"Unknown date"})]})]})},b.name))})}),o.jsx("div",{className:"mt-4 pt-4 border-t border-border flex justify-end gap-2",children:o.jsx(V,{variant:"outline",onClick:t,children:"Cancel"})})]})},Kr=({onUploadFile:e,onSelectFromStorage:t,onCancel:n,isUploading:r=!1,bucketName:s="photos"})=>{const[a,i]=l.useState("upload"),c=(d,u)=>{const p=u.replace(/\.[^/.]+$/,"").replace(/[-_]/g," ");t(d,p)};return o.jsx("div",{className:"w-full max-w-6xl mx-auto",children:o.jsxs(Er,{value:a,onValueChange:i,children:[o.jsxs(Rr,{className:"grid w-full grid-cols-2",children:[o.jsxs(on,{value:"upload",className:"flex items-center gap-2",children:[o.jsx(kn,{className:"w-4 h-4"}),"Upload New"]}),o.jsxs(on,{value:"browse",className:"flex items-center gap-2",children:[o.jsx(kr,{className:"w-4 h-4"}),"Browse Storage"]})]}),o.jsx(an,{value:"upload",className:"mt-6",children:o.jsx(Yr,{onUpload:e,onCancel:n,isUploading:r})}),o.jsx(an,{value:"browse",className:"mt-6",children:o.jsx(Gr,{onSelectFile:c,onCancel:n,bucketName:s})})]})})},Jr=(n,...r)=>F(void 0,[n,...r],function*(e,t={}){const{maxWidth:s=1920,maxHeight:a=1080,quality:i=.85,thumbnailSize:c=400}=t,d=new Image,u=URL.createObjectURL(e);return new Promise((p,f)=>{d.onload=()=>F(void 0,null,function*(){try{URL.revokeObjectURL(u);const{width:g,height:h}=dn(d.width,d.height,s,a),{width:v,height:m}=dn(d.width,d.height,c,c),[x,w,S,j]=yield Promise.all([rt(d,g,h,"image/jpeg",i),rt(d,g,h,"image/webp",i),rt(d,v,m,"image/jpeg",.8),rt(d,v,m,"image/webp",.8)]);p({original:x,webp:w,thumbnail:S,thumbnailWebp:j})}catch(g){f(g)}}),d.onerror=()=>{URL.revokeObjectURL(u),f(new Error("Failed to load image"))},d.src=u})}),dn=(e,t,n,r)=>{let s=e,a=t;const i=s/a;return s>n&&(s=n,a=s/i),a>r&&(a=r,s=a*i),{width:Math.round(s),height:Math.round(a)}},rt=(e,t,n,r,s)=>new Promise((a,i)=>{const c=document.createElement("canvas"),d=c.getContext("2d");if(!d){i(new Error("Could not get canvas context"));return}c.width=t,c.height=n,d.imageSmoothingEnabled=!0,d.imageSmoothingQuality="high",d.drawImage(e,0,0,t,n),c.toBlob(u=>{u?a(u):i(new Error("Failed to create blob"))},r,s)}),Qr=()=>{const[e,t]=l.useState([]),[n,r]=l.useState(!0),{toast:s}=In(),a=()=>F(void 0,null,function*(){try{const{data:f,error:g}=yield Q.from("photos").select("*").order("grid_position");if(g){console.error("Error fetching photos:",g),s({title:"Error",description:"Failed to load photos",variant:"destructive"});return}const h=(f||[]).map(v=>R(y({},v),{object_fit:v.object_fit||"cover"}));t(h)}catch(f){console.error("Error fetching photos:",f),s({title:"Error",description:"Failed to load photos",variant:"destructive"})}finally{r(!1)}}),i=(f,g)=>F(void 0,null,function*(){try{const{error:h}=yield Q.from("photos").update(g).eq("id",f);return h?(console.error("Error updating photo:",h),s({title:"Error",description:"Failed to update photo",variant:"destructive"}),!1):(t(v=>v.map(m=>m.id===f?y(y({},m),g):m)),s({title:"Success",description:"Photo updated successfully"}),!0)}catch(h){return console.error("Error updating photo:",h),s({title:"Error",description:"Failed to update photo",variant:"destructive"}),!1}}),c=f=>F(void 0,null,function*(){try{const{data:g,error:h}=yield Q.from("photos").insert([f]).select().single();if(h)return console.error("Error adding photo:",h),s({title:"Error",description:"Failed to add photo",variant:"destructive"}),!1;const v=R(y({},g),{object_fit:g.object_fit||"cover"});return t(m=>[...m,v]),s({title:"Success",description:"Photo added successfully"}),!0}catch(g){return console.error("Error adding photo:",g),s({title:"Error",description:"Failed to add photo",variant:"destructive"}),!1}}),d=f=>F(void 0,null,function*(){try{const g=e.find(v=>v.id===f),{error:h}=yield Q.from("photos").delete().eq("id",f);if(h)return console.error("Error deleting photo:",h),s({title:"Error",description:"Failed to delete photo",variant:"destructive"}),!1;if(g!=null&&g.src&&g.src.includes("supabase"))try{const m=new URL(g.src).pathname.split("/"),x=m[m.length-1],{error:w}=yield Q.storage.from("photos").remove([x])}catch(v){console.warn("Failed to delete file from storage:",v)}return t(v=>v.filter(m=>m.id!==f)),s({title:"Success",description:"Photo deleted successfully"}),!0}catch(g){return console.error("Error deleting photo:",g),s({title:"Error",description:"Failed to delete photo",variant:"destructive"}),!1}}),u=f=>F(void 0,null,function*(){try{const g=f.map((m,x)=>Q.from("photos").update({grid_position:x}).eq("id",m.id));return(yield Promise.all(g)).some(m=>m.error)?(console.error("Error reordering photos"),s({title:"Error",description:"Failed to reorder photos",variant:"destructive"}),!1):(t(f.map((m,x)=>R(y({},m),{grid_position:x}))),s({title:"Success",description:"Photos reordered successfully"}),!0)}catch(g){return console.error("Error reordering photos:",g),s({title:"Error",description:"Failed to reorder photos",variant:"destructive"}),!1}}),p=(f,g)=>F(void 0,null,function*(){try{s({title:"Processing",description:"Optimizing image..."});const h=yield Jr(f),v=`${Math.random().toString(36).substring(2)}-${Date.now()}`,m=[{blob:h.original,suffix:".jpg",key:"src"},{blob:h.webp,suffix:".webp",key:"webp_src"},{blob:h.thumbnail,suffix:"_thumb.jpg",key:"thumbnail_src"},{blob:h.thumbnailWebp,suffix:"_thumb.webp",key:"thumbnail_webp_src"}],x={};for(const S of m){const j=`${v}${S.suffix}`,{error:N}=yield Q.storage.from("photos").upload(j,S.blob);if(N)throw console.error(`Error uploading ${S.key}:`,N),N;const{data:k}=Q.storage.from("photos").getPublicUrl(j);x[S.key]=k.publicUrl}const w=yield c({src:x.src,webp_src:x.webp_src,thumbnail_src:x.thumbnail_src,thumbnail_webp_src:x.thumbnail_webp_src,alt:g,grid_position:e.length,grid_class:"col-span-1 row-span-1"});return w&&s({title:"Success",description:"Photo uploaded and optimized successfully"}),w}catch(h){return console.error("Error in uploadPhoto:",h),s({title:"Error",description:"Failed to upload photo",variant:"destructive"}),!1}});return l.useEffect(()=>{a()},[]),{photos:e,loading:n,updatePhoto:i,addPhoto:c,uploadPhoto:p,deletePhoto:d,reorderPhotos:u,refetch:a}};function Zr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.useMemo(()=>r=>{t.forEach(s=>s(r))},t)}const ft=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined";function ke(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Mt(e){return"nodeType"in e}function W(e){var t,n;return e?ke(e)?e:Mt(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function It(e){const{Document:t}=W(e);return e instanceof t}function qe(e){return ke(e)?!1:e instanceof W(e).HTMLElement}function On(e){return e instanceof W(e).SVGElement}function Me(e){return e?ke(e)?e.document:Mt(e)?It(e)?e:qe(e)||On(e)?e.ownerDocument:document:document:document}const se=ft?l.useLayoutEffect:l.useEffect;function At(e){const t=l.useRef(e);return se(()=>{t.current=e}),l.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function es(){const e=l.useRef(null),t=l.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=l.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Ve(e,t){t===void 0&&(t=[e]);const n=l.useRef(e);return se(()=>{n.current!==e&&(n.current=e)},t),n}function Ye(e,t){const n=l.useRef();return l.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function it(e){const t=At(e),n=l.useRef(null),r=l.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function Ct(e){const t=l.useRef();return l.useEffect(()=>{t.current=e},[e]),t.current}let wt={};function Ge(e,t){return l.useMemo(()=>{if(t)return t;const n=wt[e]==null?0:wt[e]+1;return wt[e]=n,e+"-"+n},[e,t])}function Ln(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((a,i)=>{const c=Object.entries(i);for(const[d,u]of c){const p=a[d];p!=null&&(a[d]=p+e*u)}return a},y({},t))}}const Re=Ln(1),We=Ln(-1);function ts(e){return"clientX"in e&&"clientY"in e}function Tt(e){if(!e)return!1;const{KeyboardEvent:t}=W(e.target);return t&&e instanceof t}function ns(e){if(!e)return!1;const{TouchEvent:t}=W(e.target);return t&&e instanceof t}function Dt(e){if(ns(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return ts(e)?{x:e.clientX,y:e.clientY}:null}const He=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[He.Translate.toString(e),He.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),un="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function rs(e){return e.matches(un)?e:e.querySelector(un)}const ss={display:"none"};function os(e){let{id:t,value:n}=e;return _.createElement("div",{id:t,style:ss},n)}function as(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return _.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function is(){const[e,t]=l.useState("");return{announce:l.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const Fn=l.createContext(null);function ls(e){const t=l.useContext(Fn);l.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function cs(){const[e]=l.useState(()=>new Set),t=l.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[l.useCallback(r=>{let{type:s,event:a}=r;e.forEach(i=>{var c;return(c=i[s])==null?void 0:c.call(i,a)})},[e]),t]}const ds={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},us={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function fs(e){let{announcements:t=us,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=ds}=e;const{announce:a,announcement:i}=is(),c=Ge("DndLiveRegion"),[d,u]=l.useState(!1);if(l.useEffect(()=>{u(!0)},[]),ls(l.useMemo(()=>({onDragStart(f){let{active:g}=f;a(t.onDragStart({active:g}))},onDragMove(f){let{active:g,over:h}=f;t.onDragMove&&a(t.onDragMove({active:g,over:h}))},onDragOver(f){let{active:g,over:h}=f;a(t.onDragOver({active:g,over:h}))},onDragEnd(f){let{active:g,over:h}=f;a(t.onDragEnd({active:g,over:h}))},onDragCancel(f){let{active:g,over:h}=f;a(t.onDragCancel({active:g,over:h}))}}),[a,t])),!d)return null;const p=_.createElement(_.Fragment,null,_.createElement(os,{id:r,value:s.draggable}),_.createElement(as,{id:c,announcement:i}));return n?Ue.createPortal(p,n):p}var L;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(L||(L={}));function lt(){}function fn(e,t){return l.useMemo(()=>({sensor:e,options:t!=null?t:{}}),[e,t])}function hs(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const ee=Object.freeze({x:0,y:0});function zn(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Un(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function gs(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function hn(e){let{left:t,top:n,height:r,width:s}=e;return[{x:t,y:n},{x:t+s,y:n},{x:t,y:n+r},{x:t+s,y:n+r}]}function Bn(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function gn(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const ps=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=gn(t,t.left,t.top),a=[];for(const i of r){const{id:c}=i,d=n.get(c);if(d){const u=zn(gn(d),s);a.push({id:c,data:{droppableContainer:i,value:u}})}}return a.sort(Un)},ms=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=hn(t),a=[];for(const i of r){const{id:c}=i,d=n.get(c);if(d){const u=hn(d),p=s.reduce((g,h,v)=>g+zn(u[v],h),0),f=Number((p/4).toFixed(4));a.push({id:c,data:{droppableContainer:i,value:f}})}}return a.sort(Un)};function vs(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),a=Math.min(t.top+t.height,e.top+e.height),i=s-r,c=a-n;if(r<s&&n<a){const d=t.width*t.height,u=e.width*e.height,p=i*c,f=p/(d+u-p);return Number(f.toFixed(4))}return 0}const bs=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const a of r){const{id:i}=a,c=n.get(i);if(c){const d=vs(c,t);d>0&&s.push({id:i,data:{droppableContainer:a,value:d}})}}return s.sort(gs)};function xs(e,t,n){return R(y({},e),{scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1})}function $n(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:ee}function ws(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return s.reduce((i,c)=>R(y({},i),{top:i.top+e*c.y,bottom:i.bottom+e*c.y,left:i.left+e*c.x,right:i.right+e*c.x}),y({},n))}}const ys=ws(1);function js(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Ss(e,t,n){const r=js(t);if(!r)return e;const{scaleX:s,scaleY:a,x:i,y:c}=r,d=e.left-i-(1-s)*parseFloat(n),u=e.top-c-(1-a)*parseFloat(n.slice(n.indexOf(" ")+1)),p=s?e.width/s:e.width,f=a?e.height/a:e.height;return{width:p,height:f,top:u,right:d+p,bottom:u+f,left:d}}const Ns={ignoreTransform:!1};function Ie(e,t){t===void 0&&(t=Ns);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:p}=W(e).getComputedStyle(e);u&&(n=Ss(n,u,p))}const{top:r,left:s,width:a,height:i,bottom:c,right:d}=n;return{top:r,left:s,width:a,height:i,bottom:c,right:d}}function pn(e){return Ie(e,{ignoreTransform:!0})}function Cs(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Ds(e,t){return t===void 0&&(t=W(e).getComputedStyle(e)),t.position==="fixed"}function Es(e,t){t===void 0&&(t=W(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const a=t[s];return typeof a=="string"?n.test(a):!1})}function ht(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(It(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!qe(s)||On(s)||n.includes(s))return n;const a=W(e).getComputedStyle(s);return s!==e&&Es(s,a)&&n.push(s),Ds(s,a)?n:r(s.parentNode)}return e?r(e):n}function _n(e){const[t]=ht(e,1);return t!=null?t:null}function yt(e){return!ft||!e?null:ke(e)?e:Mt(e)?It(e)||e===Me(e).scrollingElement?window:qe(e)?e:null:null}function Vn(e){return ke(e)?e.scrollX:e.scrollLeft}function Wn(e){return ke(e)?e.scrollY:e.scrollTop}function Et(e){return{x:Vn(e),y:Wn(e)}}var z;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(z||(z={}));function Hn(e){return!ft||!e?!1:e===document.scrollingElement}function Xn(e){const t={x:0,y:0},n=Hn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,a=e.scrollLeft<=t.x,i=e.scrollTop>=r.y,c=e.scrollLeft>=r.x;return{isTop:s,isLeft:a,isBottom:i,isRight:c,maxScroll:r,minScroll:t}}const Rs={x:.2,y:.2};function ks(e,t,n,r,s){let{top:a,left:i,right:c,bottom:d}=n;r===void 0&&(r=10),s===void 0&&(s=Rs);const{isTop:u,isBottom:p,isLeft:f,isRight:g}=Xn(e),h={x:0,y:0},v={x:0,y:0},m={height:t.height*s.y,width:t.width*s.x};return!u&&a<=t.top+m.height?(h.y=z.Backward,v.y=r*Math.abs((t.top+m.height-a)/m.height)):!p&&d>=t.bottom-m.height&&(h.y=z.Forward,v.y=r*Math.abs((t.bottom-m.height-d)/m.height)),!g&&c>=t.right-m.width?(h.x=z.Forward,v.x=r*Math.abs((t.right-m.width-c)/m.width)):!f&&i<=t.left+m.width&&(h.x=z.Backward,v.x=r*Math.abs((t.left+m.width-i)/m.width)),{direction:h,speed:v}}function Ms(e){if(e===document.scrollingElement){const{innerWidth:a,innerHeight:i}=window;return{top:0,left:0,right:a,bottom:i,width:a,height:i}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function qn(e){return e.reduce((t,n)=>Re(t,Et(n)),ee)}function Is(e){return e.reduce((t,n)=>t+Vn(n),0)}function As(e){return e.reduce((t,n)=>t+Wn(n),0)}function Ts(e,t){if(t===void 0&&(t=Ie),!e)return;const{top:n,left:r,bottom:s,right:a}=t(e);_n(e)&&(s<=0||a<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Ps=[["x",["left","right"],Is],["y",["top","bottom"],As]];class Pt{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=ht(n),s=qn(r);this.rect=y({},t),this.width=t.width,this.height=t.height;for(const[a,i,c]of Ps)for(const d of i)Object.defineProperty(this,d,{get:()=>{const u=c(r),p=s[a]-u;return this.rect[d]+p},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Be{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function Os(e){const{EventTarget:t}=W(e);return e instanceof t?e:Me(e)}function jt(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(xt(n,2)+xt(r,2))>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var Z;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Z||(Z={}));function mn(e){e.preventDefault()}function Ls(e){e.stopPropagation()}var T;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(T||(T={}));const Yn={start:[T.Space,T.Enter],cancel:[T.Esc],end:[T.Space,T.Enter,T.Tab]},Fs=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case T.Right:return R(y({},n),{x:n.x+25});case T.Left:return R(y({},n),{x:n.x-25});case T.Down:return R(y({},n),{y:n.y+25});case T.Up:return R(y({},n),{y:n.y-25})}};class Ot{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Be(Me(n)),this.windowListeners=new Be(W(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Z.Resize,this.handleCancel),this.windowListeners.add(Z.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Z.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&Ts(r),n(ee)}handleKeyDown(t){if(Tt(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:a=Yn,coordinateGetter:i=Fs,scrollBehavior:c="smooth"}=s,{code:d}=t;if(a.end.includes(d)){this.handleEnd(t);return}if(a.cancel.includes(d)){this.handleCancel(t);return}const{collisionRect:u}=r.current,p=u?{x:u.left,y:u.top}:ee;this.referenceCoordinates||(this.referenceCoordinates=p);const f=i(t,{active:n,context:r.current,currentCoordinates:p});if(f){const g=We(f,p),h={x:0,y:0},{scrollableAncestors:v}=r.current;for(const m of v){const x=t.code,{isTop:w,isRight:S,isLeft:j,isBottom:N,maxScroll:k,minScroll:A}=Xn(m),D=Ms(m),M={x:Math.min(x===T.Right?D.right-D.width/2:D.right,Math.max(x===T.Right?D.left:D.left+D.width/2,f.x)),y:Math.min(x===T.Down?D.bottom-D.height/2:D.bottom,Math.max(x===T.Down?D.top:D.top+D.height/2,f.y))},C=x===T.Right&&!S||x===T.Left&&!j,E=x===T.Down&&!N||x===T.Up&&!w;if(C&&M.x!==f.x){const I=m.scrollLeft+g.x,b=x===T.Right&&I<=k.x||x===T.Left&&I>=A.x;if(b&&!g.y){m.scrollTo({left:I,behavior:c});return}b?h.x=m.scrollLeft-I:h.x=x===T.Right?m.scrollLeft-k.x:m.scrollLeft-A.x,h.x&&m.scrollBy({left:-h.x,behavior:c});break}else if(E&&M.y!==f.y){const I=m.scrollTop+g.y,b=x===T.Down&&I<=k.y||x===T.Up&&I>=A.y;if(b&&!g.x){m.scrollTo({top:I,behavior:c});return}b?h.y=m.scrollTop-I:h.y=x===T.Down?m.scrollTop-k.y:m.scrollTop-A.y,h.y&&m.scrollBy({top:-h.y,behavior:c});break}}this.handleMove(t,Re(We(f,this.referenceCoordinates),h))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Ot.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=Yn,onActivation:s}=t,{active:a}=n;const{code:i}=e.nativeEvent;if(r.start.includes(i)){const c=a.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function vn(e){return!!(e&&"distance"in e)}function bn(e){return!!(e&&"delay"in e)}class Lt{constructor(t,n,r){var s;r===void 0&&(r=Os(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:a}=t,{target:i}=a;this.props=t,this.events=n,this.document=Me(i),this.documentListeners=new Be(this.document),this.listeners=new Be(r),this.windowListeners=new Be(W(i)),this.initialCoordinates=(s=Dt(a))!=null?s:ee,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Z.Resize,this.handleCancel),this.windowListeners.add(Z.DragStart,mn),this.windowListeners.add(Z.VisibilityChange,this.handleCancel),this.windowListeners.add(Z.ContextMenu,mn),this.documentListeners.add(Z.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(bn(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(vn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Z.Click,Ls,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Z.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:a}=this,{onMove:i,options:{activationConstraint:c}}=a;if(!s)return;const d=(n=Dt(t))!=null?n:ee,u=We(s,d);if(!r&&c){if(vn(c)){if(c.tolerance!=null&&jt(u,c.tolerance))return this.handleCancel();if(jt(u,c.distance))return this.handleStart()}if(bn(c)&&jt(u,c.tolerance))return this.handleCancel();this.handlePending(c,u);return}t.cancelable&&t.preventDefault(),i(d)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===T.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const zs={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Ft extends Lt{constructor(t){const{event:n}=t,r=Me(n.target);super(t,zs,r)}}Ft.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Us={move:{name:"mousemove"},end:{name:"mouseup"}};var Rt;(function(e){e[e.RightClick=2]="RightClick"})(Rt||(Rt={}));class Bs extends Lt{constructor(t){super(t,Us,Me(t.event.target))}}Bs.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===Rt.RightClick?!1:(r==null||r({event:n}),!0)}}];const St={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class $s extends Lt{constructor(t){super(t,St)}static setup(){return window.addEventListener(St.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(St.move.name,t)};function t(){}}}$s.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var $e;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})($e||($e={}));var ct;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(ct||(ct={}));function _s(e){let{acceleration:t,activator:n=$e.Pointer,canScroll:r,draggingRect:s,enabled:a,interval:i=5,order:c=ct.TreeOrder,pointerCoordinates:d,scrollableAncestors:u,scrollableAncestorRects:p,delta:f,threshold:g}=e;const h=Ws({delta:f,disabled:!a}),[v,m]=es(),x=l.useRef({x:0,y:0}),w=l.useRef({x:0,y:0}),S=l.useMemo(()=>{switch(n){case $e.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case $e.DraggableRect:return s}},[n,s,d]),j=l.useRef(null),N=l.useCallback(()=>{const A=j.current;if(!A)return;const D=x.current.x*w.current.x,M=x.current.y*w.current.y;A.scrollBy(D,M)},[]),k=l.useMemo(()=>c===ct.TreeOrder?[...u].reverse():u,[c,u]);l.useEffect(()=>{if(!a||!u.length||!S){m();return}for(const A of k){if((r==null?void 0:r(A))===!1)continue;const D=u.indexOf(A),M=p[D];if(!M)continue;const{direction:C,speed:E}=ks(A,M,S,t,g);for(const I of["x","y"])h[I][C[I]]||(E[I]=0,C[I]=0);if(E.x>0||E.y>0){m(),j.current=A,v(N,i),x.current=E,w.current=C;return}}x.current={x:0,y:0},w.current={x:0,y:0},m()},[t,N,r,m,a,i,JSON.stringify(S),JSON.stringify(h),v,u,k,p,JSON.stringify(g)])}const Vs={x:{[z.Backward]:!1,[z.Forward]:!1},y:{[z.Backward]:!1,[z.Forward]:!1}};function Ws(e){let{delta:t,disabled:n}=e;const r=Ct(t);return Ye(s=>{if(n||!r||!s)return Vs;const a={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[z.Backward]:s.x[z.Backward]||a.x===-1,[z.Forward]:s.x[z.Forward]||a.x===1},y:{[z.Backward]:s.y[z.Backward]||a.y===-1,[z.Forward]:s.y[z.Forward]||a.y===1}}},[n,t,r])}function Hs(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Ye(s=>{var a;return t==null?null:(a=r!=null?r:s)!=null?a:null},[r,t])}function Xs(e,t){return l.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,a=s.activators.map(i=>({eventName:i.eventName,handler:t(i.handler,r)}));return[...n,...a]},[]),[e,t])}var Xe;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Xe||(Xe={}));var kt;(function(e){e.Optimized="optimized"})(kt||(kt={}));const xn=new Map;function qs(e,t){let{dragging:n,dependencies:r,config:s}=t;const[a,i]=l.useState(null),{frequency:c,measure:d,strategy:u}=s,p=l.useRef(e),f=x(),g=Ve(f),h=l.useCallback(function(w){w===void 0&&(w=[]),!g.current&&i(S=>S===null?w:S.concat(w.filter(j=>!S.includes(j))))},[g]),v=l.useRef(null),m=Ye(w=>{if(f&&!n)return xn;if(!w||w===xn||p.current!==e||a!=null){const S=new Map;for(let j of e){if(!j)continue;if(a&&a.length>0&&!a.includes(j.id)&&j.rect.current){S.set(j.id,j.rect.current);continue}const N=j.node.current,k=N?new Pt(d(N),N):null;j.rect.current=k,k&&S.set(j.id,k)}return S}return w},[e,a,n,f,d]);return l.useEffect(()=>{p.current=e},[e]),l.useEffect(()=>{f||h()},[n,f]),l.useEffect(()=>{a&&a.length>0&&i(null)},[JSON.stringify(a)]),l.useEffect(()=>{f||typeof c!="number"||v.current!==null||(v.current=setTimeout(()=>{h(),v.current=null},c))},[c,f,h,...r]),{droppableRects:m,measureDroppableContainers:h,measuringScheduled:a!=null};function x(){switch(u){case Xe.Always:return!1;case Xe.BeforeDragging:return n;default:return!n}}}function Gn(e,t){return Ye(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Ys(e,t){return Gn(e,t)}function Gs(e){let{callback:t,disabled:n}=e;const r=At(t),s=l.useMemo(()=>{if(n||typeof window=="undefined"||typeof window.MutationObserver=="undefined")return;const{MutationObserver:a}=window;return new a(r)},[r,n]);return l.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function gt(e){let{callback:t,disabled:n}=e;const r=At(t),s=l.useMemo(()=>{if(n||typeof window=="undefined"||typeof window.ResizeObserver=="undefined")return;const{ResizeObserver:a}=window;return new a(r)},[n]);return l.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function Ks(e){return new Pt(Ie(e),e)}function wn(e,t,n){t===void 0&&(t=Ks);const[r,s]=l.useState(null);function a(){s(d=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=d!=null?d:n)!=null?u:null}const p=t(e);return JSON.stringify(d)===JSON.stringify(p)?d:p})}const i=Gs({callback(d){if(e)for(const u of d){const{type:p,target:f}=u;if(p==="childList"&&f instanceof HTMLElement&&f.contains(e)){a();break}}}}),c=gt({callback:a});return se(()=>{a(),e?(c==null||c.observe(e),i==null||i.observe(document.body,{childList:!0,subtree:!0})):(c==null||c.disconnect(),i==null||i.disconnect())},[e]),r}function Js(e){const t=Gn(e);return $n(e,t)}const yn=[];function Qs(e){const t=l.useRef(e),n=Ye(r=>e?r&&r!==yn&&e&&t.current&&e.parentNode===t.current.parentNode?r:ht(e):yn,[e]);return l.useEffect(()=>{t.current=e},[e]),n}function Zs(e){const[t,n]=l.useState(null),r=l.useRef(e),s=l.useCallback(a=>{const i=yt(a.target);i&&n(c=>c?(c.set(i,Et(i)),new Map(c)):null)},[]);return l.useEffect(()=>{const a=r.current;if(e!==a){i(a);const c=e.map(d=>{const u=yt(d);return u?(u.addEventListener("scroll",s,{passive:!0}),[u,Et(u)]):null}).filter(d=>d!=null);n(c.length?new Map(c):null),r.current=e}return()=>{i(e),i(a)};function i(c){c.forEach(d=>{const u=yt(d);u==null||u.removeEventListener("scroll",s)})}},[s,e]),l.useMemo(()=>e.length?t?Array.from(t.values()).reduce((a,i)=>Re(a,i),ee):qn(e):ee,[e,t])}function jn(e,t){t===void 0&&(t=[]);const n=l.useRef(null);return l.useEffect(()=>{n.current=null},t),l.useEffect(()=>{const r=e!==ee;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?We(e,n.current):ee}function eo(e){l.useEffect(()=>{if(!ft)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function to(e,t){return l.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:a}=r;return n[s]=i=>{a(i,t)},n},{}),[e,t])}function Kn(e){return l.useMemo(()=>e?Cs(e):null,[e])}const Sn=[];function no(e,t){t===void 0&&(t=Ie);const[n]=e,r=Kn(n?W(n):null),[s,a]=l.useState(Sn);function i(){a(()=>e.length?e.map(d=>Hn(d)?r:new Pt(t(d),d)):Sn)}const c=gt({callback:i});return se(()=>{c==null||c.disconnect(),i(),e.forEach(d=>c==null?void 0:c.observe(d))},[e]),s}function ro(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return qe(t)?t:e}function so(e){let{measure:t}=e;const[n,r]=l.useState(null),s=l.useCallback(u=>{for(const{target:p}of u)if(qe(p)){r(f=>{const g=t(p);return f?R(y({},f),{width:g.width,height:g.height}):g});break}},[t]),a=gt({callback:s}),i=l.useCallback(u=>{const p=ro(u);a==null||a.disconnect(),p&&(a==null||a.observe(p)),r(p?t(p):null)},[t,a]),[c,d]=it(i);return l.useMemo(()=>({nodeRef:c,rect:n,setRef:d}),[n,c,d])}const oo=[{sensor:Ft,options:{}},{sensor:Ot,options:{}}],ao={current:{}},ot={draggable:{measure:pn},droppable:{measure:pn,strategy:Xe.WhileDragging,frequency:kt.Optimized},dragOverlay:{measure:Ie}};class _e extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const io={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new _e,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:lt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:ot,measureDroppableContainers:lt,windowRect:null,measuringScheduled:!1},lo={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:lt,draggableNodes:new Map,over:null,measureDroppableContainers:lt},pt=l.createContext(lo),Jn=l.createContext(io);function co(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new _e}}}function uo(e,t){switch(t.type){case L.DragStart:return R(y({},e),{draggable:R(y({},e.draggable),{initialCoordinates:t.initialCoordinates,active:t.active})});case L.DragMove:return e.draggable.active==null?e:R(y({},e),{draggable:R(y({},e.draggable),{translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}})});case L.DragEnd:case L.DragCancel:return R(y({},e),{draggable:R(y({},e.draggable),{active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}})});case L.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new _e(e.droppable.containers);return s.set(r,n),R(y({},e),{droppable:R(y({},e.droppable),{containers:s})})}case L.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,a=e.droppable.containers.get(n);if(!a||r!==a.key)return e;const i=new _e(e.droppable.containers);return i.set(n,R(y({},a),{disabled:s})),R(y({},e),{droppable:R(y({},e.droppable),{containers:i})})}case L.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const a=new _e(e.droppable.containers);return a.delete(n),R(y({},e),{droppable:R(y({},e.droppable),{containers:a})})}default:return e}}function fo(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=l.useContext(pt),a=Ct(r),i=Ct(n==null?void 0:n.id);return l.useEffect(()=>{if(!t&&!r&&a&&i!=null){if(!Tt(a)||document.activeElement===a.target)return;const c=s.get(i);if(!c)return;const{activatorNode:d,node:u}=c;if(!d.current&&!u.current)return;requestAnimationFrame(()=>{for(const p of[d.current,u.current]){if(!p)continue;const f=rs(p);if(f){f.focus();break}}})}},[r,t,s,i,a]),null}function ho(e,t){let s=t,{transform:n}=s,r=ve(s,["transform"]);return e!=null&&e.length?e.reduce((a,i)=>i(y({transform:a},r)),n):n}function go(e){return l.useMemo(()=>({draggable:y(y({},ot.draggable),e==null?void 0:e.draggable),droppable:y(y({},ot.droppable),e==null?void 0:e.droppable),dragOverlay:y(y({},ot.dragOverlay),e==null?void 0:e.dragOverlay)}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function po(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const a=l.useRef(!1),{x:i,y:c}=typeof s=="boolean"?{x:s,y:s}:s;se(()=>{if(!i&&!c||!t){a.current=!1;return}if(a.current||!r)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const p=n(u),f=$n(p,r);if(i||(f.x=0),c||(f.y=0),a.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const g=_n(u);g&&g.scrollBy({top:f.y,left:f.x})}},[t,i,c,r,n])}const Qn=l.createContext(R(y({},ee),{scaleX:1,scaleY:1}));var be;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(be||(be={}));const mo=l.memo(function(t){var n,r,s,a;let Yt=t,{id:i,accessibility:c,autoScroll:d=!0,children:u,sensors:p=oo,collisionDetection:f=bs,measuring:g,modifiers:h}=Yt,v=ve(Yt,["id","accessibility","autoScroll","children","sensors","collisionDetection","measuring","modifiers"]);const m=l.useReducer(uo,void 0,co),[x,w]=m,[S,j]=cs(),[N,k]=l.useState(be.Uninitialized),A=N===be.Initialized,{draggable:{active:D,nodes:M,translate:C},droppable:{containers:E}}=x,I=D!=null?M.get(D):null,b=l.useRef({initial:null,translated:null}),P=l.useMemo(()=>{var B;return D!=null?{id:D,data:(B=I==null?void 0:I.data)!=null?B:ao,rect:b}:null},[D,I]),K=l.useRef(null),[oe,Ke]=l.useState(null),[H,Je]=l.useState(null),ae=Ve(v,Object.values(v)),Ae=Ge("DndDescribedBy",i),Qe=l.useMemo(()=>E.getEnabled(),[E]),$=go(g),{droppableRects:ie,measureDroppableContainers:we,measuringScheduled:Te}=qs(Qe,{dragging:A,dependencies:[C.x,C.y],config:$.droppable}),X=Hs(M,D),Ze=l.useMemo(()=>H?Dt(H):null,[H]),ue=ur(),le=Ys(X,$.draggable.measure);po({activeNode:D!=null?M.get(D):null,config:ue.layoutShiftCompensation,initialRect:le,measure:$.draggable.measure});const O=wn(X,$.draggable.measure,le),Pe=wn(X?X.parentElement:null),te=l.useRef({activatorEvent:null,active:null,activeNode:X,collisionRect:null,collisions:null,droppableRects:ie,draggableNodes:M,draggingNode:null,draggingNodeRect:null,droppableContainers:E,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),je=E.getNodeFor((n=te.current.over)==null?void 0:n.id),ce=so({measure:$.dragOverlay.measure}),Se=(r=ce.nodeRef.current)!=null?r:X,Ne=A?(s=ce.rect)!=null?s:O:null,Bt=!!(ce.nodeRef.current&&ce.rect),$t=Js(Bt?null:O),mt=Kn(Se?W(Se):null),fe=Qs(A?je!=null?je:X:null),et=no(fe),tt=ho(h,{transform:{x:C.x-$t.x,y:C.y-$t.y,scaleX:1,scaleY:1},activatorEvent:H,active:P,activeNodeRect:O,containerNodeRect:Pe,draggingNodeRect:Ne,over:te.current.over,overlayNodeRect:ce.rect,scrollableAncestors:fe,scrollableAncestorRects:et,windowRect:mt}),_t=Ze?Re(Ze,C):null,Vt=Zs(fe),sr=jn(Vt),or=jn(Vt,[O]),Ce=Re(tt,sr),De=Ne?ys(Ne,tt):null,Oe=P&&De?f({active:P,collisionRect:De,droppableRects:ie,droppableContainers:Qe,pointerCoordinates:_t}):null,Wt=Bn(Oe,"id"),[he,Ht]=l.useState(null),ar=Bt?tt:Re(tt,or),ir=xs(ar,(a=he==null?void 0:he.rect)!=null?a:null,O),vt=l.useRef(null),Xt=l.useCallback((B,q)=>{let{sensor:Y,options:ge}=q;if(K.current==null)return;const J=M.get(K.current);if(!J)return;const G=B.nativeEvent,ne=new Y({active:K.current,activeNode:J,event:G,options:ge,context:te,onAbort(U){if(!M.get(U))return;const{onDragAbort:re}=ae.current,de={id:U};re==null||re(de),S({type:"onDragAbort",event:de})},onPending(U,pe,re,de){if(!M.get(U))return;const{onDragPending:Fe}=ae.current,me={id:U,constraint:pe,initialCoordinates:re,offset:de};Fe==null||Fe(me),S({type:"onDragPending",event:me})},onStart(U){const pe=K.current;if(pe==null)return;const re=M.get(pe);if(!re)return;const{onDragStart:de}=ae.current,Le={activatorEvent:G,active:{id:pe,data:re.data,rect:b}};Ue.unstable_batchedUpdates(()=>{de==null||de(Le),k(be.Initializing),w({type:L.DragStart,initialCoordinates:U,active:pe}),S({type:"onDragStart",event:Le}),Ke(vt.current),Je(G)})},onMove(U){w({type:L.DragMove,coordinates:U})},onEnd:Ee(L.DragEnd),onCancel:Ee(L.DragCancel)});vt.current=ne;function Ee(U){return function(){return F(this,null,function*(){const{active:re,collisions:de,over:Le,scrollAdjustedTranslate:Fe}=te.current;let me=null;if(re&&Fe){const{cancelDrop:ze}=ae.current;me={activatorEvent:G,active:re,collisions:de,delta:Fe,over:Le},U===L.DragEnd&&typeof ze=="function"&&(yield Promise.resolve(ze(me)))&&(U=L.DragCancel)}K.current=null,Ue.unstable_batchedUpdates(()=>{w({type:U}),k(be.Uninitialized),Ht(null),Ke(null),Je(null),vt.current=null;const ze=U===L.DragEnd?"onDragEnd":"onDragCancel";if(me){const bt=ae.current[ze];bt==null||bt(me),S({type:ze,event:me})}})})}}},[M]),lr=l.useCallback((B,q)=>(Y,ge)=>{const J=Y.nativeEvent,G=M.get(ge);if(K.current!==null||!G||J.dndKit||J.defaultPrevented)return;const ne={active:G};B(Y,q.options,ne)===!0&&(J.dndKit={capturedBy:q.sensor},K.current=ge,Xt(Y,q))},[M,Xt]),qt=Xs(p,lr);eo(p),se(()=>{O&&N===be.Initializing&&k(be.Initialized)},[O,N]),l.useEffect(()=>{const{onDragMove:B}=ae.current,{active:q,activatorEvent:Y,collisions:ge,over:J}=te.current;if(!q||!Y)return;const G={active:q,activatorEvent:Y,collisions:ge,delta:{x:Ce.x,y:Ce.y},over:J};Ue.unstable_batchedUpdates(()=>{B==null||B(G),S({type:"onDragMove",event:G})})},[Ce.x,Ce.y]),l.useEffect(()=>{const{active:B,activatorEvent:q,collisions:Y,droppableContainers:ge,scrollAdjustedTranslate:J}=te.current;if(!B||K.current==null||!q||!J)return;const{onDragOver:G}=ae.current,ne=ge.get(Wt),Ee=ne&&ne.rect.current?{id:ne.id,rect:ne.rect.current,data:ne.data,disabled:ne.disabled}:null,U={active:B,activatorEvent:q,collisions:Y,delta:{x:J.x,y:J.y},over:Ee};Ue.unstable_batchedUpdates(()=>{Ht(Ee),G==null||G(U),S({type:"onDragOver",event:U})})},[Wt]),se(()=>{te.current={activatorEvent:H,active:P,activeNode:X,collisionRect:De,collisions:Oe,droppableRects:ie,draggableNodes:M,draggingNode:Se,draggingNodeRect:Ne,droppableContainers:E,over:he,scrollableAncestors:fe,scrollAdjustedTranslate:Ce},b.current={initial:Ne,translated:De}},[P,X,Oe,De,M,Se,Ne,ie,E,he,fe,Ce]),_s(R(y({},ue),{delta:C,draggingRect:De,pointerCoordinates:_t,scrollableAncestors:fe,scrollableAncestorRects:et}));const cr=l.useMemo(()=>({active:P,activeNode:X,activeNodeRect:O,activatorEvent:H,collisions:Oe,containerNodeRect:Pe,dragOverlay:ce,draggableNodes:M,droppableContainers:E,droppableRects:ie,over:he,measureDroppableContainers:we,scrollableAncestors:fe,scrollableAncestorRects:et,measuringConfiguration:$,measuringScheduled:Te,windowRect:mt}),[P,X,O,H,Oe,Pe,ce,M,E,ie,he,we,fe,et,$,Te,mt]),dr=l.useMemo(()=>({activatorEvent:H,activators:qt,active:P,activeNodeRect:O,ariaDescribedById:{draggable:Ae},dispatch:w,draggableNodes:M,over:he,measureDroppableContainers:we}),[H,qt,P,O,w,Ae,M,he,we]);return _.createElement(Fn.Provider,{value:j},_.createElement(pt.Provider,{value:dr},_.createElement(Jn.Provider,{value:cr},_.createElement(Qn.Provider,{value:ir},u)),_.createElement(fo,{disabled:(c==null?void 0:c.restoreFocus)===!1})),_.createElement(fs,R(y({},c),{hiddenTextDescribedById:Ae})));function ur(){const B=(oe==null?void 0:oe.autoScrollEnabled)===!1,q=typeof d=="object"?d.enabled===!1:d===!1,Y=A&&!B&&!q;return typeof d=="object"?R(y({},d),{enabled:Y}):{enabled:Y}}}),vo=l.createContext(null),Nn="button",bo="Draggable";function xo(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const a=Ge(bo),{activators:i,activatorEvent:c,active:d,activeNodeRect:u,ariaDescribedById:p,draggableNodes:f,over:g}=l.useContext(pt),{role:h=Nn,roleDescription:v="draggable",tabIndex:m=0}=s!=null?s:{},x=(d==null?void 0:d.id)===t,w=l.useContext(x?Qn:vo),[S,j]=it(),[N,k]=it(),A=to(i,t),D=Ve(n);se(()=>(f.set(t,{id:t,key:a,node:S,activatorNode:N,data:D}),()=>{const C=f.get(t);C&&C.key===a&&f.delete(t)}),[f,t]);const M=l.useMemo(()=>({role:h,tabIndex:m,"aria-disabled":r,"aria-pressed":x&&h===Nn?!0:void 0,"aria-roledescription":v,"aria-describedby":p.draggable}),[r,h,m,x,v,p.draggable]);return{active:d,activatorEvent:c,activeNodeRect:u,attributes:M,isDragging:x,listeners:r?void 0:A,node:S,over:g,setNodeRef:j,setActivatorNodeRef:k,transform:w}}function wo(){return l.useContext(Jn)}const yo="Droppable",jo={timeout:25};function So(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const a=Ge(yo),{active:i,dispatch:c,over:d,measureDroppableContainers:u}=l.useContext(pt),p=l.useRef({disabled:n}),f=l.useRef(!1),g=l.useRef(null),h=l.useRef(null),{disabled:v,updateMeasurementsFor:m,timeout:x}=y(y({},jo),s),w=Ve(m!=null?m:r),S=l.useCallback(()=>{if(!f.current){f.current=!0;return}h.current!=null&&clearTimeout(h.current),h.current=setTimeout(()=>{u(Array.isArray(w.current)?w.current:[w.current]),h.current=null},x)},[x]),j=gt({callback:S,disabled:v||!i}),N=l.useCallback((M,C)=>{j&&(C&&(j.unobserve(C),f.current=!1),M&&j.observe(M))},[j]),[k,A]=it(N),D=Ve(t);return l.useEffect(()=>{!j||!k.current||(j.disconnect(),f.current=!1,j.observe(k.current))},[k,j]),l.useEffect(()=>(c({type:L.RegisterDroppable,element:{id:r,key:a,disabled:n,node:k,rect:g,data:D}}),()=>c({type:L.UnregisterDroppable,key:a,id:r})),[r]),l.useEffect(()=>{n!==p.current.disabled&&(c({type:L.SetDroppableDisabled,id:r,key:a,disabled:n}),p.current.disabled=n)},[r,a,n,c]),{active:i,rect:g,isOver:(d==null?void 0:d.id)===r,node:k,over:d,setNodeRef:A}}function zt(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function No(e,t){return e.reduce((n,r,s)=>{const a=t.get(r);return a&&(n[s]=a),n},Array(e.length))}function st(e){return e!==null&&e>=0}function Co(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Do(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Ut=e=>{let{rects:t,activeIndex:n,overIndex:r,index:s}=e;const a=zt(t,r,n),i=t[s],c=a[s];return!c||!i?null:{x:c.left-i.left,y:c.top-i.top,scaleX:c.width/i.width,scaleY:c.height/i.height}},Zn="Sortable",er=_.createContext({activeIndex:-1,containerId:Zn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Ut,disabled:{draggable:!1,droppable:!1}});function Eo(e){let{children:t,id:n,items:r,strategy:s=Ut,disabled:a=!1}=e;const{active:i,dragOverlay:c,droppableRects:d,over:u,measureDroppableContainers:p}=wo(),f=Ge(Zn,n),g=c.rect!==null,h=l.useMemo(()=>r.map(A=>typeof A=="object"&&"id"in A?A.id:A),[r]),v=i!=null,m=i?h.indexOf(i.id):-1,x=u?h.indexOf(u.id):-1,w=l.useRef(h),S=!Co(h,w.current),j=x!==-1&&m===-1||S,N=Do(a);se(()=>{S&&v&&p(h)},[S,h,v,p]),l.useEffect(()=>{w.current=h},[h]);const k=l.useMemo(()=>({activeIndex:m,containerId:f,disabled:N,disableTransforms:j,items:h,overIndex:x,useDragOverlay:g,sortedRects:No(h,d),strategy:s}),[m,f,N.draggable,N.droppable,j,h,x,d,g,s]);return _.createElement(er.Provider,{value:k},t)}const Ro=e=>{let{id:t,items:n,activeIndex:r,overIndex:s}=e;return zt(n,r,s).indexOf(t)},ko=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:s,items:a,newIndex:i,previousItems:c,previousContainerId:d,transition:u}=e;return!u||!r||c!==a&&s===i?!1:n?!0:i!==s&&t===d},Mo={duration:200,easing:"ease"},tr="transform",Io=He.Transition.toString({property:tr,duration:0,easing:"linear"}),Ao={roleDescription:"sortable"};function To(e){let{disabled:t,index:n,node:r,rect:s}=e;const[a,i]=l.useState(null),c=l.useRef(n);return se(()=>{if(!t&&n!==c.current&&r.current){const d=s.current;if(d){const u=Ie(r.current,{ignoreTransform:!0}),p={x:d.left-u.left,y:d.top-u.top,scaleX:d.width/u.width,scaleY:d.height/u.height};(p.x||p.y)&&i(p)}}n!==c.current&&(c.current=n)},[t,n,r,s]),l.useEffect(()=>{a&&i(null)},[a]),a}function Po(e){let{animateLayoutChanges:t=ko,attributes:n,disabled:r,data:s,getNewIndex:a=Ro,id:i,strategy:c,resizeObserverConfig:d,transition:u=Mo}=e;const{items:p,containerId:f,activeIndex:g,disabled:h,disableTransforms:v,sortedRects:m,overIndex:x,useDragOverlay:w,strategy:S}=l.useContext(er),j=Oo(r,h),N=p.indexOf(i),k=l.useMemo(()=>y({sortable:{containerId:f,index:N,items:p}},s),[f,s,N,p]),A=l.useMemo(()=>p.slice(p.indexOf(i)),[p,i]),{rect:D,node:M,isOver:C,setNodeRef:E}=So({id:i,data:k,disabled:j.droppable,resizeObserverConfig:y({updateMeasurementsFor:A},d)}),{active:I,activatorEvent:b,activeNodeRect:P,attributes:K,setNodeRef:oe,listeners:Ke,isDragging:H,over:Je,setActivatorNodeRef:ae,transform:Ae}=xo({id:i,data:k,attributes:y(y({},Ao),n),disabled:j.draggable}),Qe=Zr(E,oe),$=!!I,ie=$&&!v&&st(g)&&st(x),we=!w&&H,Te=we&&ie?Ae:null,X=c!=null?c:S,Ze=ie?Te!=null?Te:X({rects:m,activeNodeRect:P,activeIndex:g,overIndex:x,index:N}):null,ue=st(g)&&st(x)?a({id:i,items:p,activeIndex:g,overIndex:x}):N,le=I==null?void 0:I.id,O=l.useRef({activeId:le,items:p,newIndex:ue,containerId:f}),Pe=p!==O.current.items,te=t({active:I,containerId:f,isDragging:H,isSorting:$,id:i,index:N,items:p,newIndex:O.current.newIndex,previousItems:O.current.items,previousContainerId:O.current.containerId,transition:u,wasDragging:O.current.activeId!=null}),je=To({disabled:!te,index:N,node:M,rect:D});return l.useEffect(()=>{$&&O.current.newIndex!==ue&&(O.current.newIndex=ue),f!==O.current.containerId&&(O.current.containerId=f),p!==O.current.items&&(O.current.items=p)},[$,ue,f,p]),l.useEffect(()=>{if(le===O.current.activeId)return;if(le!=null&&O.current.activeId==null){O.current.activeId=le;return}const Se=setTimeout(()=>{O.current.activeId=le},50);return()=>clearTimeout(Se)},[le]),{active:I,activeIndex:g,attributes:K,data:k,rect:D,index:N,newIndex:ue,items:p,isOver:C,isSorting:$,isDragging:H,listeners:Ke,node:M,overIndex:x,over:Je,setNodeRef:Qe,setActivatorNodeRef:ae,setDroppableNodeRef:E,setDraggableNodeRef:oe,transform:je!=null?je:Ze,transition:ce()};function ce(){if(je||Pe&&O.current.newIndex===N)return Io;if(!(we&&!Tt(b)||!u)&&($||te))return He.Transition.toString(R(y({},u),{property:tr}))}}function Oo(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function dt(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Lo=[T.Down,T.Right,T.Up,T.Left],Fo=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:s,droppableContainers:a,over:i,scrollableAncestors:c}}=t;if(Lo.includes(e.code)){if(e.preventDefault(),!n||!r)return;const d=[];a.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const g=s.get(f.id);if(g)switch(e.code){case T.Down:r.top<g.top&&d.push(f);break;case T.Up:r.top>g.top&&d.push(f);break;case T.Left:r.left>g.left&&d.push(f);break;case T.Right:r.left<g.left&&d.push(f);break}});const u=ms({active:n,collisionRect:r,droppableRects:s,droppableContainers:d,pointerCoordinates:null});let p=Bn(u,"id");if(p===(i==null?void 0:i.id)&&u.length>1&&(p=u[1].id),p!=null){const f=a.get(n.id),g=a.get(p),h=g?s.get(g.id):null,v=g==null?void 0:g.node.current;if(v&&h&&f&&g){const x=ht(v).some((A,D)=>c[D]!==A),w=nr(f,g),S=zo(f,g),j=x||!w?{x:0,y:0}:{x:S?r.width-h.width:0,y:S?r.height-h.height:0},N={x:h.left,y:h.top};return j.x&&j.y?N:We(N,j)}}}};function nr(e,t){return!dt(e)||!dt(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function zo(e,t){return!dt(e)||!dt(t)||!nr(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const Uo=({photo:e,index:t,isEditMode:n,onEdit:r,onPreview:s})=>{const{attributes:a,listeners:i,setNodeRef:c,transform:d,transition:u,isDragging:p}=Po({id:e.id}),f={transform:He.Transform.toString(d),transition:u,opacity:p?.5:1};return console.log("SortablePhoto render - photo:",e.id,"isEditMode:",n),o.jsx("div",R(y(y({ref:c,style:f,className:`group cursor-pointer animate-fade-in ${e.grid_class} ${n?"border-2 border-dashed border-primary/30":""}`},a),n?i:{}),{children:o.jsxs("div",{className:"relative w-full overflow-hidden bg-card shadow-lg hover:shadow-xl transition-all duration-500 group-hover:scale-[1.02]",onClick:()=>!n&&s(e),children:[o.jsx(_r,{ratio:4/3,children:o.jsx(Nt,{src:e.src,alt:e.alt,objectFit:e.object_fit||"cover",fastPreview:t===0,priority:t===0,eager:t===0,className:"w-full h-full transition-transform duration-700 group-hover:scale-105",webpSrc:e.webp_src,thumbnailSrc:e.thumbnail_src,thumbnailWebpSrc:e.thumbnail_webp_src})}),n&&o.jsx("div",{className:"absolute inset-0 bg-black/30 flex items-center justify-center z-10",children:o.jsxs(V,{size:"sm",variant:"secondary",onClick:g=>{g.stopPropagation(),console.log("Photo edit button clicked for photo:",e.id),r(e)},className:"bg-white/90 text-black hover:bg-white shadow-lg",children:[o.jsx(jr,{className:"w-4 h-4 mr-2"}),"Edit"]})})]})}))},Bo=()=>{const[e,t]=l.useState(!1),[n,r]=l.useState(null),[s,a]=l.useState(null),[i,c]=l.useState(!1),[d,u]=l.useState(!1),[p,f]=l.useState(null),{photos:g,loading:h,updatePhoto:v,addPhoto:m,uploadPhoto:x,deletePhoto:w,reorderPhotos:S}=Qr();l.useEffect(()=>{F(void 0,null,function*(){var b;const{data:{session:I}}=yield Q.auth.getSession();f((b=I==null?void 0:I.user)!=null?b:null)});const{data:{subscription:E}}=Q.auth.onAuthStateChange((I,b)=>{var P;f((P=b==null?void 0:b.user)!=null?P:null)});return()=>E.unsubscribe()},[]),l.useEffect(()=>{var C;if(g.length>0&&((C=g[0])!=null&&C.src)){const E=document.createElement("link");return E.rel="preload",E.as="image",E.href=g[0].src,E.fetchPriority="high",document.head.appendChild(E),()=>{document.head.contains(E)&&document.head.removeChild(E)}}},[g]),console.log("PhotographyGrid render - photos:",g,"loading:",h,"isEditMode:",e);const j=hs(fn(Ft),fn(Ot,{coordinateGetter:Fo})),N=C=>{const{active:E,over:I}=C;if(I&&E.id!==I.id){const b=g.findIndex(oe=>oe.id===E.id),P=g.findIndex(oe=>oe.id===I.id),K=zt(g,b,P);S(K)}},k=C=>F(void 0,null,function*(){yield v(C.id,{src:C.src,alt:C.alt,grid_class:C.grid_class,object_fit:C.object_fit}),r(null)}),A=C=>F(void 0,null,function*(){yield w(C),r(null)}),D=(C,E)=>F(void 0,null,function*(){u(!0);try{(yield x(C,E))&&c(!1)}finally{u(!1)}}),M=(C,E)=>F(void 0,null,function*(){u(!0);try{(yield m({src:C,alt:E,grid_class:"col-span-1 row-span-1",grid_position:g.length,object_fit:"cover"}))&&c(!1)}finally{u(!1)}});return h?o.jsx("section",{id:"photography",className:"py-20 px-8 bg-background",children:o.jsx("div",{className:"max-w-7xl mx-auto",children:o.jsx("div",{className:"text-center",children:o.jsx("div",{className:"animate-pulse",children:"Loading photos..."})})})}):o.jsx("section",{id:"photography",className:"mt-24 py-12 px-8 bg-background",children:o.jsxs("div",{className:"max-w-7xl mx-auto",children:[o.jsxs("div",{className:"flex justify-between items-center mb-16 animate-fade-in",children:[o.jsx("div",{className:"text-center flex-1",children:o.jsxs("div",{className:"text-left max-w-2xl leading-tight tracking-tight",children:[o.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:"Curated Collection of"}),o.jsx("p",{className:"text-xl md:text-2xl font-bold bg-gradient-to-r from-primary via-primary-glow to-primary bg-clip-text text-transparent",children:"Selected Photographs"})]})}),!1]}),e&&i&&o.jsxs("div",{className:"mb-8 p-6 border border-dashed border-primary/30 rounded-lg bg-card",children:[o.jsx("h3",{className:"text-lg font-medium mb-4",children:"Add Photo"}),o.jsx(Kr,{onUploadFile:D,onSelectFromStorage:M,onCancel:()=>c(!1),isUploading:d,bucketName:"photos"})]}),e&&!i&&o.jsx("div",{className:"mb-8 text-center",children:o.jsxs(V,{variant:"outline",onClick:()=>c(!0),className:"border-dashed",children:[o.jsx(yr,{className:"w-4 h-4 mr-2"}),"Add New Photo"]})}),o.jsx(mo,{sensors:j,collisionDetection:ps,onDragEnd:N,children:o.jsx(Eo,{items:g.map(C=>C.id),strategy:Ut,children:o.jsx("div",{className:"grid grid-cols-3 grid-rows-2 auto-rows-[200px] gap-4 mb-12",children:g.map((C,E)=>o.jsx(Uo,{photo:C,index:E,isEditMode:e&&!!p,onEdit:r,onPreview:a},C.id))})})}),!e&&o.jsx("div",{className:"text-center animate-fade-in",children:o.jsx(V,{variant:"outline",size:"lg",className:"px-8 py-3 border-foreground text-foreground hover:bg-foreground hover:text-background rounded-full font-medium",children:"See More Photography"})}),o.jsx(qr,{photo:n,isOpen:!!n,onClose:()=>r(null),onSave:k,onDelete:A}),o.jsx(An,{open:!!s,onOpenChange:()=>a(null),children:o.jsx(Tn,{className:"max-w-4xl max-h-[90vh] p-0 bg-black/95",children:s&&o.jsx("div",{className:"relative w-full h-full flex items-center justify-center",children:o.jsxs("picture",{children:[s.webp_src&&o.jsx("source",{srcSet:s.webp_src,type:"image/webp"}),o.jsx("img",{src:s.src,alt:s.alt,className:"max-w-full max-h-[90vh] object-contain"})]})})})})]})})},$o=vr,rr=l.forwardRef((r,n)=>{var s=r,{className:e}=s,t=ve(s,["className"]);return o.jsx(Cn,R(y({className:ut("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e)},t),{ref:n}))});rr.displayName=Cn.displayName;const _o=Sr("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Vo=l.forwardRef((a,s)=>{var i=a,{side:e="right",className:t,children:n}=i,r=ve(i,["side","className","children"]);return o.jsxs($o,{children:[o.jsx(rr,{}),o.jsxs(Dn,R(y({ref:s,className:ut(_o({side:e}),t)},r),{children:[n,o.jsxs(mr,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[o.jsx(Mn,{className:"h-4 w-4"}),o.jsx("span",{className:"sr-only",children:"Close"})]})]}))]})});Vo.displayName=Dn.displayName;const Wo=l.forwardRef((r,n)=>{var s=r,{className:e}=s,t=ve(s,["className"]);return o.jsx(En,y({ref:n,className:ut("text-lg font-semibold text-foreground",e)},t))});Wo.displayName=En.displayName;const Ho=l.forwardRef((r,n)=>{var s=r,{className:e}=s,t=ve(s,["className"]);return o.jsx(Rn,y({ref:n,className:ut("text-sm text-muted-foreground",e)},t))});Ho.displayName=Rn.displayName;const ca=()=>{const[e,t]=l.useState(null);return l.useEffect(()=>{F(void 0,null,function*(){const{data:{user:r}}=yield Q.auth.getUser();t(r)})},[]),o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(xr,{}),o.jsx(Ur,{}),o.jsx(Bo,{}),!1]})};export{ca as default};
